type: Group
instructions:
  - type: EnvironmentVariable
    variableName: QTEST_ENVIRONMENT
    variableValue: "ci"
  - type: AppendToEnvironmentVariable
    variableName: PATH
    variableValue: ":{{.AgentWorkingDir}}/install/bin/"
    disable_if:
      condition: property
      property: host.os
      equals_value: Windows
  - type: AppendToEnvironmentVariable
    variableName: PATH
    variableValue: ";{{.AgentWorkingDir}}\\install\\bin"
    enable_if:
      condition: property
      property: host.os
      equals_value: Windows
  - type: EnvironmentVariable
    variableName: PYTHON3_PATH
    variableValue: "{{ index .Env \"PYTHON3.10.0-64_PATH\"}}"
    enable_if:
      condition: property
      property: host.os
      equals_value: Windows
  - type: PrependToEnvironmentVariable
    variableName: PATH
    variableValue: "{{.Env.PYTHON3_PATH}}\\;"
    enable_if:
      condition: property
      property: host.os
      equals_value: Windows
  - type: AppendToEnvironmentVariable
    variableName: PATH
    variableValue: :/Users/qt/.local/bin/:/Users/qt/.pyenv/versions/3.9.7/bin/
    enable_if:
      condition: property
      property: host.os
      equals_value: MacOS
  - type: EnvironmentVariable
    variableName: QTDIR
    variableValue: "{{.AgentWorkingDir}}\\install"
    enable_if:
      condition: property
      property: host.compiler
      equals_value: MSVC2022
  - type: EnvironmentVariable
    variableName: TARGET_ARCHITECTURE
    variableValue: amd64
    enable_if:
      condition: and
      conditions:
        - condition: property
          property: target.arch
          equals_value: X86_64
        - condition: property
          property: host.os
          equals_value: Windows
  - type: EnvironmentVariable
    variableName: VC_SCRIPT
    variableValue: "\\Program Files\\Microsoft Visual Studio\\2022\\Professional\\VC\\Auxiliary\\Build\\vcvars64.bat"
    enable_if:
      condition: property
      property: host.compiler
      equals_value: MSVC2022
  - type: WriteFile
    fileContents: "call \"{{.Env.VC_SCRIPT}}\" \r\ncmd /c %*"
    filename: "c:\\users\\qt\\MSVC.bat"
    fileMode: 420
    enable_if:
      condition: property
      property: host.os
      equals_value: Windows
